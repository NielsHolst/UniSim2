Simulation sim {
  .iterations = 16384
  .steps = 6288
  .silent = TRUE
  .unattended = TRUE
  Box random {
    RandomiserSobolSequence randomiser {
      .doSensitivityAnalysis = TRUE
      .bootstrapSize = 10000
    }
    RandomUniform Cinit {
      .min   = 0.01
      .max   = 0.60
    }
    RandomUniform Ninit {
      .min   = 0.011
      .max   = 0.022
    }
    RandomUniform Ainit {
      .min   = 0.00065 
      .max   = 0.00075 
    }
    RandomUniform Iden {
      .min   = 100 
      .max   = 900
    }
    RandomUniform A0 {
      .min   = 1 
      .max   = 8
    }
    RandomUniform m1 {
      .min   = 0.004520833
      .max   = 0.005445833 
    }
    RandomUniform m2 {
      .min   = 0.0004166667
      .max   = 0.001625 
    }
    RandomUniform a {
      .min   = 0.36
      .max   = 1.08 
    }
    RandomUniform b {
      .min   = 0.14
      .max   = 0.42 
    }
    RandomUniform U0 {
      .min   = 0.0225
      .max   = 0.0675 
    }
    RandomUniform KX {
      .min   = 0.002
      .max   = 0.006 
    }
    RandomUniform Jmax { // check v√¶rdier
      .min   = 0.0000616
      .max   = 0.0001960
    }
    RandomUniform a1 {
      .min   = 0
      .max   = 0.85
    }
    RandomUniform a2 {
      .min   = 0
      .max   = 0.3
    }
    RandomUniform eps {
      .min   = 0
      .max   = 0.33
    }
    RandomUniform gamma {
      .min   = 0.25
      .max   = 0.75 
    }
  }

  Box fixed {
    +Nmin = 0.01
  }
  
  Calendar calendar {
    .initialDateTime = "2017-09-21 00:05:00"
    .timeUnit = "h"
    .latitude = 56.25 
    // Uncomment lines below in newer versions of UniSim
    +dayLength = ./sun[dayLength]
    Sun sun {
    }
  }
  Records env {
    .fileName = "env_file_2017.txt"
  }
  Carboncontent carboncontent {
    .Cinit =  random/Cinit[value]
    .carbonreservesrate = rateofchangeincarbonreserves[carbonreservesrate]
  }
  Carbonexudation carbonexudation {
    .C = carboncontent[C]
  }
  Nitrogencontent nitrogencontent {
    .Ninit = random/Ninit[value]
    .nitrogenreservesrate = rateofchangeinnitrogenreserves[nitrogenreservesrate]
  }
  Fronderosion fronderosion {
    .A = area[A]
    .eps = random/eps[value]
  }
  Temperaturedepententrespiration respiration {
    .T = env[T]
  }
  LightInhibition beta {
    .Pmax = maxphotoreftemp[maxphotosynthesisreftemp]
    .guessBeta = 1e-9
    .report = FALSE
  }  
  Photosynthesis photo  {
    .beta = beta[beta]
  }  
  Maximalphotosynthesisratereftemp maxphotoreftemp {
    .T = env[T]
  }
  Grossphotosynthesis grossphotosynthesis {
    .PS = photo[photosynthesis]
    .beta = beta[beta]
    .I = env[I]
  }
  Nitrateuptakerate nitrateuptakerate {
    .X = env[N]
    .N = nitrogencontent[N]
    .U = env[U]
    .Nmin = fixed[Nmin]
    .a    = random/a[value]
    .b    = random/b[value]
    .U0   = random/U0[value]
    .KX   = random/KX[value]
    .Jmax = random/Jmax[value]
  }  
  Seasonalinfluenceongrowthrate fphoto {
    .dayLength = calendar[dayLength]
    .maxDayLengthChange = 0.07832
    .a1 = random/a1[value]
    .a2 = random/a2[value]
  }
  Salinity fsalinity {
    .S = env[S]
  }
  Effectoftemperatureongrowthrate ftemp {
    .T = env[T]
  }
  Effectofsizeongrowthrate farea {
    .A = area[A]
    .A0 = random/A0[value]
    .m1 = random/m1[value]
    .m2 = random/m2[value]
  }
  Arealost arealost {
    .A = area[A]
    .C = carboncontent[C]
  }
  Area area {
    .Ainit = random/Ainit[value]
    .fronderosion = fronderosion[fronderosion]
    .Alost = arealost[Alost]
    .u = specificgrowthrate[specificgrowthrate]
    .Factor = 1
  }
  Specificgrowthrate specificgrowthrate {
    .farea = farea[farea]
    .fphoto = 1 //fphoto[fphoto]
    .ftemp = ftemp[ftemp]
    .fsalinity = fsalinity[fsalinity]
    .N = nitrogencontent[N]
    .C = carboncontent[C]
    .Nmin = fixed[Nmin]
  }
  Rateofchangeincarbonreserves rateofchangeincarbonreserves {
    .Gphotosynthesis = grossphotosynthesis[Gphotosynthesis]
    .Cexudation = carbonexudation[carbonexudation]
    .Respiration = respiration[respiration]
    .C = carboncontent[C]
    .u = specificgrowthrate[specificgrowthrate]
  }
  Rateofchangeinnitrogenreserves rateofchangeinnitrogenreserves {
    .J = nitrateuptakerate[Nuptakerate]
    .u = specificgrowthrate[specificgrowthrate]
    .N = nitrogencontent[N]
  }
  Rateofchangeoffrondarea rateofchangeoffrondarea {
    .u = specificgrowthrate[specificgrowthrate]
    .A = area[A]
    .fronderosion = fronderosion[fronderosion]
  }
  Dryweight dryweight {
    .A = area[A]
    .N = nitrogencontent[N]
    .C = carboncontent[C]
  }
  Structuraldryweight structuraldryweight {
    .A = area[A]
  }
  Wetweight wetweight {
    .A = area[A]
    .N = nitrogencontent[N]
    .C = carboncontent[C]
  }
  Totalcarbon totalcarbon {
    .C = carboncontent[C]
    .Ws = structuraldryweight[Ws]
  }
  Totalnitrogen totalnitrogen {
    .N = nitrogencontent[N]
    .Ws = structuraldryweight[Ws]
  }
  Yieldprm yield {
    .Iden = random/Iden[value]
    .Ww = wetweight[Ww]
  }
 OutputR {
    Box outputs {
      +logAspring = area[logA]
    }
    PageR {
      .xAxis = random/*[value]
      .width = 10
      .height = 4
      PlotR {
        .ports = ../../outputs[*]|end
        .maxData = 1000
        .ggplot = "geom_smooth(colour='yellow')"
      }
    }
    PageR {
      .xAxis = random/*[value]
      .width = 10
      .height = 4
      PlotR {
        .ports = ../../outputs[*]|end
        .type = "SobolConvergence"
        .fontSize = 11
      }
    }
    PageR {
      .xAxis = random/*[value]
      .width = 5
      .height = 7
      PlotR {
        .ports = ../../outputs[*]|end
        .type = "SobolIndices"
      }
    }
  }
}